@model Homework8.Models.Item

@{
    ViewBag.Title = "Details";
}

<h2>Item Details Page</h2>

<div>
    <h4>Item</h4>
    <hr />
    <dl class="dl-horizontal">
        <dt>
            @Html.DisplayNameFor(model => model.Seller.Name)
        </dt>

        <dd>
            @Html.DisplayFor(model => model.Seller.Name)
        </dd>

        <dt>
            @Html.DisplayNameFor(model => model.Name)
        </dt>

        <dd>
            @Html.DisplayFor(model => model.Name)
        </dd>

        <dt>
            @Html.DisplayNameFor(model => model.Description)
        </dt>

        <dd>
            @Html.DisplayFor(model => model.Description)
        </dd>
    </dl>
    <!-- Need a spot to display items -->
    <span class="hidden" id="itemSpan">@Model.ItemID</span>
    <div id="display">

    </div>
</div>
<p>
    @Html.ActionLink("Edit", "Edit", new { id = Model.ItemID }) |
    @Html.ActionLink("Back to List", "Index")
</p>

@Scripts.Render("~/bundles/jquery")
<script>
    window.setInterval(ajax_update, 3000);

    function ajax_update()
    {
        var id = @Model.ItemID;
        $ajax
            ({
                type: 'GET',
                dataType: 'JSON',
                url: 'Items/ListBids/' + id,
                data: { id: id },
                success: displayList,
                error: oops
            });
    }

    function displayList(data)
    {
        $('#display').empty();
        var item = document.getElementById("display");
        data.updated.forEach(function (item)
        {
            $('#display').append(item)
        })
        console.log(data);
    }

    function oops()
    {
        console.log("Oops, something went wrong.");
    }
</script>